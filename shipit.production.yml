ci:
  require: []

dependencies:
  override:
    # We are making sure the deploys point to the NPM registry to prevent
    # 404 issues like the one described in this comment:
    # https://github.com/yarnpkg/yarn/issues/2935#issuecomment-355292633
    - echo 'registry "https://registry.npmjs.org/"' | tee .npmrc .yarnrc
    - curl -fsSL https://get.pnpm.io/install.sh | PNPM_VERSION=9.14.2 SHELL=`which bash` bash -
    - bash -i -c "pnpm install"
deploy:
  override:
    - bash -i -c "npm_config_loglevel=verbose pnpm clean"
    - bash -i -c "npm_config_loglevel=verbose NODE_ENV=production pnpm bundle"
    - bash -i -c "npm_config_loglevel=verbose node bin/create-cli-duplicate-package.js"
    - bash -i -c "npm_config_loglevel=verbose pnpm changeset publish"
    - bash -i -c "./bin/package.js"
    - bash -i -c "./bin/create-doc-pr.js"
